
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>OPS-1024 Troubleshooting Article</title>
<style>
body {
    font-family: Arial, sans-serif;
    margin: 40px;
    line-height: 1.7;
    background-color: #f9f9f9;
}
.container {
    background: white;
    padding: 40px;
    border-radius: 8px;
    box-shadow: 0px 4px 10px rgba(0,0,0,0.05);
}
ul, ol {
    margin-left: 25px;
}

li {
    margin-bottom: 8px;
}
h1, h2, h3 {
    color: #2c3e50;
}
code {
    background-color: #f4f4f4;
    padding: 4px 6px;
    border-radius: 4px;
}
pre {
    background-color: #f4f4f4;
    padding: 12px;
    overflow-x: auto;
    border-radius: 6px;
}
footer {
    margin-top: 40px;
    font-size: 12px;
    color: gray;
}
</style>
</head>
<body>
<div class="container">
<h1>Troubleshooting Article â€“ OPS-1024</h1>
<h1>Production API Server Inaccessible Due to Full Filesystem</h1>
<h2>Issue Summary</h2>
<p>Production API server became unreachable, leading to slow SSH login times and frequent application container restarts. Upon investigation, it was found that the root partition utilization reached 100%, preventing services from writing logs and temporary files.</p>
<h2>Description</h2>
<p>The production environment of our API server experienced a critical issue where it went down entirely due to insufficient disk space on its root filesystem. This resulted in slow SSH connections as well as frequent restarts of application containers because they were unable to write their log files or store other necessary data temporarily.</p>
<p>Upon further investigation, it was identified that the root partition was at 100% utilization, indicating a severe storage problem caused by uncontrolled growth of application log files and an absence of automated log rotation settings. </p>
<h2>Root Cause Analysis</h2>
<h3>Factors Contributing to the Problem:</h3>
<ul>
<li>
<p><strong>Uncontrolled Growth of Application Log Files:</strong> The API server had no mechanism in place for automatic logging file management or rotation.</p>
</li>
<li>
<p><strong>Insufficient Disk Space Allocation:</strong> Given the high frequency of writes required by application logs, even a moderate amount of data could quickly fill up disk space.</p>
</li>
</ul>
<h3>Consequences:</h3>
<ul>
<li>
<p>Application containers were restarting due to the inability to write log files.</p>
</li>
<li>
<p>SSH connections became slow because of the heavy load on the server's storage system.</p>
</li>
<li>
<p>The root filesystem was reaching its maximum capacity, preventing further file creation and potentially causing more critical issues down the line.</p>
</li>
</ul>
<h2>Troubleshooting &amp; Resolution Steps</h2>
<ol>
<li><strong>Identify Large Log Files:</strong> Use <code>du -a /var/log | sort -n</code> to find directories with large files occupying significant space on the root partition.</li>
<li><strong>Delete Unnecessary Logs:</strong> Manually delete older log files that are no longer required, such as those from development or test environments.</li>
<li><strong>Implement Daily Log Rotation Using logrotate</strong>: Configure a daily rotation policy using <code>logrotate</code>:</li>
</ol>
<ul>
<li>
<p>Create <code>/etc/logrotate.d/api-server.conf</code>: 
     <code>ini
     /var/log/api/* {
         weekly
         rotate 52
         create 640 root adm
         compress
     }</code></p>
</li>
<li>
<p>Update crontab with the log rotation command: <code>crontab -e</code> and add:
     <code>cron
     1 3 * * * /usr/sbin/logrotate /etc/logrotate.conf</code>
4. <strong>Increase Disk Space:</strong> Add additional storage to the root filesystem by allocating an additional 20GB of disk space.
5. <strong>Set Up Alerts for Disk Usage:</strong> Configure alerts at critical thresholds (e.g., 80% and 90%) so that the DevOps team is notified in a timely manner, enabling swift action if disk usage reaches these limits.</p>
</li>
</ul>
<h2>Preventive Measures</h2>
<ol>
<li><strong>Regularly Monitor Log File Sizes:</strong> Utilize tools like <code>logrotate</code> to automatically manage log file sizes.</li>
<li><strong>Implement Automated Disk Usage Alerts:</strong> Set up alerts for critical disk usage thresholds using system monitoring tools such as Nagios or Prometheus, to ensure timely detection and resolution of potential issues.</li>
<li><strong>Maintain Adequate Buffer Space:</strong> Allocate sufficient buffer space to handle peak loads without overwriting existing logs.</li>
<li><strong>Review Storage Policies:</strong> Ensure that storage policies are aligned with current needs, particularly regarding log file retention durations.</li>
</ol>
<h2>Conclusion</h2>
<p>By proactively addressing the root causes of the issue and implementing preventive measures, we have mitigated future disk usage issues on our API server's root filesystem. These steps include automating daily log rotation, increasing available storage space, and setting up alerts for critical threshold conditions to ensure smooth operation under anticipated growth scenarios.</p>
<h2>References</h2>
<ul>
<li>
<p><a href="https://linux.die.net/man/8/logrotate">logrotate Official Documentation</a></p>
</li>
<li>
<p><a href="http://nagios.sourceforge.io/docs/3r1/cfg.html#ALERTS">Nagios Alert Configuration Guide</a></p>
</li>
</ul>
<hr />
<p><strong>Note:</strong> The provided script and configurations are based on common Linux environments. Depending on the specific environment, adjustments may be necessary.</p>
<footer>
Generated on 2026-02-28 01:02:48
</footer>
</div>
</body>
</html>
